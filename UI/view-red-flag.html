<!DOCTYPE html>
<html>
<head>
	<title>Some corruption related title | iReporter</title>

	<link rel="stylesheet" type="text/css" href="assets/css/ireporter.css" />
	<link rel="stylesheet" type="text/css" href="assets/css/navbar2.css" />
	<link rel="stylesheet" type="text/css" href="assets/css/font-awesome.min.css" />
	<link rel="stylesheet" type="text/css" href="assets/css/view-record.css" />
	<link rel="stylesheet" type="text/css" href="assets/css/user.css" />

	<script src="assets/js/ireporter.js"></script>
	<script src="assets/js/api.js"></script>
	<script src="assets/js/app.js"></script>
	<script>
	function showMap(lat, long) {
      const map = new google.maps.Map(
      	document.getElementById('map-container'),
      	{
      	  zoom: 4,
      	  center: {
      	  	lat,
      	  	lng: long
      	  }
      	});
      const marker = new google.maps.Marker({
      	position: {
      	  lat,
      	  lng: long
      	},
      	map
      });
	}
	</script>
	<script>
	app.setAuthRequired(true);
	app.ready(http => {
	  const id = http.params['id'];
	  if (typeof id == 'undefined') {
	  	http.redirect('./red-flags.html');
	  }

	  http.api(`red-flags/${id}`).get((data) => {
	  	const incident = data[0];

	  	// Title
	  	app.dom.selector('.js-title-text').html(incident.title);

	  	// Status
	  	let status = incident.status.split('-');
	  	status = status.join(' ').toUpperCase();
	  	app.dom.selector('.record-status').addClass(incident.status).html(status);

	  	// Date
	  	app.dom.selector('.js-time-text').html(incident.createdon);

	  	// Comment
	    app.dom.selector('.record-content .comment').html(incident.comment);

        // Add map
	    if (incident.latitude && incident.longitude) {
	      app.dom.selector('.record-content').addClass('has-map');

	      app.dom.selector('.js-coords-text').html(`(${incident.latitude}&deg;, ${incident.longitude}&deg;)`);

	      var googleMapApi = document.createElement('script')
	      googleMapApi.setAttribute('src',
	      	`https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=showMap(${incident.latitude},${incident.longitude})`);
	      document.head.appendChild(googleMapApi);
	    }
	  }, (error) => {
	  	console.log(error);
	  });
	});
	app.start();
	</script>
</head>
<body>
	<div class="red-bg">
		<div class="container">
			<div id="navbar">
				<a href="dashboard.html" class="sitename">iReporter</a>
				<div class="navbar-menu">
					<ul>
						<li><a href="red-flags.html">Red Flags</a></li>
						<li><a href="interventions.html">Interventions</a></li>
						<li class="dropdown">
							<a href="#">Account <i class="fa fa-caret-down"></i></a>
							<ul class="dropdown-menu">
								<li><a href="profile.html">My Profile</a></li>
								<li><a href="index.html">Log out</a></li>
							</ul>
						</li>
					</ul>
				</div>
				<div class="clearfix"></div>
			</div>
		</div>
	</div>
	<div>
		<div class="container">
			<div>
				<div class="navigation"><a href="red-flags.html">Red Flags</a> / <span class="js-title-text"></span></div>
				<div class="title js-title-text"></div>
				<div class="info-wrapper"><span class="info date">Created <span class="js-time-text"></span></span> <span class="info record-status no-select"></span></div>
			</div>
			<div class="record-content">
				<div class="comment"></div>
				<div class="map-wrapper">
					<div><i class="fa fa-map-marker"></i> <span class="js-coords-text"></span></div>
					<div id="map-container"></div>
				</div>
				<!-- <div class="media-section">
					<div class="section-header"><i class="fa fa-image"></i> Media</div>
					<div class="media-wrapper">
						<a class="media pull-left">
							<img src="#" alt="media" />
							<div class="download"><i class="fa fa-arrow-down fa-2x"></i></div>
						</a>
						<a class="media pull-left">
							<img src="#" alt="media" />
							<div class="download"><i class="fa fa-arrow-down fa-2x"></i></div>
						</a>
						<a class="media pull-left">
							<img src="#" alt="media" />
							<div class="download"><i class="fa fa-arrow-down fa-2x"></i></div>
						</a>
						<a class="media pull-left">
							<img src="#" alt="media" />
							<div class="download"><i class="fa fa-arrow-down fa-2x"></i></div>
						</a>
						<div class="clearfix"></div>
					</div>
				</div> -->
			</div>
		</div>
	</div>
</body>
</html>